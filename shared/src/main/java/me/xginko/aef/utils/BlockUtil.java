package me.xginko.aef.utils;

import org.bukkit.Material;
import org.bukkit.block.BlockState;
import org.bukkit.block.data.Waterlogged;

import java.util.EnumMap;
import java.util.Map;

public class BlockUtil {

    private static final boolean WATERLOGGED_AVAILABLE;

    static {
        WATERLOGGED_AVAILABLE = Crafty.hasClass("org.bukkit.block.data.Waterlogged");
    }

    public static boolean isWaterloggedAvailable() {
        return WATERLOGGED_AVAILABLE;
    }

    private static final Map<Material, Boolean> IS_WATERLOGGABLE_CACHE = new EnumMap<>(Material.class);
    public static boolean isWaterlogged(BlockState blockState) {
        return  blockState != null
                && IS_WATERLOGGABLE_CACHE.computeIfAbsent(blockState.getType(), k -> blockState.getBlockData() instanceof Waterlogged)
                && ((Waterlogged) blockState.getBlockData()).isWaterlogged();
    }
}
